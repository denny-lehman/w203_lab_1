---
title: "Lab 1 Group 3, Legislator age"
author: "Team03: Savita Chari, Tymon Silva, Denny Lehman "
output: html_notebook
editor_options: 
  chunk_output_type: inline
chunk_output_type: Inline
---

## Study question 2: Wrong Test, Right Data
### Our Analysis:
The response categories in Likert scales creates rank order/ordinal data, but the intervals between their values cannot be compared or presumed equal.Therefore, standard statistical analysis such as  the mean, standard deviation etc. are inappropriate for ordinal data. Hence, this data is not suitable for a paired t-test. Paired t-test is parametric which means it expects a normal distribution of metric scaled data in its test population. It may be used for ordinal data such as True/False but for our use case a non-parametric test such as  Wilcoxon signed-rank test or Sign test would be a better  choice.   

## Study question 3: Legislator age
#### You would like to test whether Democratic or Republican senators are older. List all assumptions for a Wilcoxon rank-sum test and evaluate them.

## Hypothesis
#### H_0: Probability that the Democrat legislators are older than Republicans is same as the probability of Republican legislators being older than their Democrat counterpart.

## What is Wilcoxon rank-sum test?
Wilcoxon rank-sum test is a non-parametric, distribution-free test for two independent samples. Though it involves assumptions, but those assumptions are less restrictive than the assumptions for parametric tests. It considers the ranks instead of the metric value of the variable. It uses the order of variables to construct statistics that can be used to test hypotheses.

$Advantage:$ The population distribution doesn't have to be normal, so it's easier to justify a rank-based test. It is a good choice of test for smaller sample size.

$Disadvantage:$ Since these tests do not use the metric information they loose statistical power.

### The Wilcox rank-sum test works on following principals:
  1. The samples are interval scale and list the score from lowest to highest. Higher rank gets higher score
  2. Only considers rank instead of looking at metric value of the variable
  3. Uses order of variables to construct statistics that is used for hypothesis
  
### The Wilcox rank-sum test makes the following assumptions:
  1. Tests independent samples
  2. The test is non-parametric i.e. the population is distribution-free
  3. Works on Un-Paired Data


```{r}
library(dplyr)
library(knitr)
library(tidyverse) 
```
```{r DATA Read , echo=False, warning=False, message=False}
setwd("C:\\Users\\savit\\lab_1\\datasets")
legislator_full_data <- read_csv("legislators-current.csv")
view(legislator_full_data)
```
##  Data and Methodology

The Data set has 538 rows and 34 columns. But we need a Subset of this data  to answer the research question
```{r Get the shape of the data in terms of number of rows and column}
Num_Of_Rows <- nrow(legislator_full_data)
Num_Of_Columns <- ncol(legislator_full_data)
sprintf('The Dataset had %i Rows and %i Columns', Num_Of_Rows ,Num_Of_Columns)
```
### In order to perform Wilcoxon test we need 2 types of columns from our dataset
1. $[X]$ A categorical column with 2 distinct groups : We chose the 'party' column for this requirement but the data set includes more than two categories. We filtered only the Republican and Democrat data in order to perform Wilcoxon rank-sum test as we are interested in only those categories. Thus we fulfill the requirement of having only 2 categories.

2. $[Y]$ A statistical column with numeric outcome: We choose the 'birthday' field for this requirement. Though this field is of class 'Date', some manipulation will be needed to make it a numeric outcome

```{r Data Cleaning  , echo=False, warning=False, message=False }
legislator_subset_data <- legislator_full_data %>%
  select (full_name, birthday, party)  %>%
    filter(party != 'Independent')

```
### Data Transformation
The birthday field is of 'Date' class and is in YYYY/MM/DD format
In order to find out the age of the legislator we calculate the current age of the legislator by doing a datediff between current date and the birthday

```{r Find the Age of every legislator}
currentDate <- Sys.Date()
legislator_DemRep_Age_data  <- legislator_subset_data %>% 
  mutate(AgeInYears = round((as.numeric(difftime(currentDate , birthday,units = "weeks")))/52))
legislator_DemRep_Age_data
```
### Exploring Assumption 1 : Are the data sets independent?
Well, yes, a legislator cannot belong to 2 parties simultaneously, so the data is independent. The source of the data is the congress-legislators project. Data such as information (first, last, etc.), biographical information (birthday, gender) of every members of the United States Congress (1789-Present) is maintained. Data of one legislator does not depend on the other.

### Exploring Assumption 2 : Is the population distribution-free?
From the graph below we can tell that the age distribution between republicans and democrats is some what normal, and not too skewed  Moreover, as per Central Limit Theorem (CMT), when we have a sufficiently large sample size (500+ in our case), the sampling distribution starts to approximate a normal distribution .

### $Given$ $this$ $information,$ $Wilcoxon$ $rank-sum$ $tes$t $is$ $not$ $a$ $good$ $choic$e $for$ $this$ $use$ $case$

```{r Age Distribution, echo=False, warning=False, message=False}
par(mfrow=c(1,3))
plot(legislator_DemRep_Age_data$AgeInYears,col ='green4',  main = "Age distribution of all Legistrators",  ylab='Age in years', xlab='Number of legistrators')

hist((legislator_DemRep_Age_data %>% select(party,AgeInYears)  %>%
    filter(party == 'Democrat'))$AgeInYears, main = "Age distribution of Democrats", col='blue3', xlab='Age in years')

hist((legislator_DemRep_Age_data %>% select(party,AgeInYears)  %>%
    filter(party == 'Republican'))$AgeInYears, main = "Age distribution of Republicans", col='red3', xlab='Age in years')


```

Also, from the box plot below, it is very clear that the we can calculate variance on the metric data.  Democrates have a bigger variance than the Republicans wrt. their age. In the Republican data set there is an outlier too.

```{r Calculate the variance in Age for Democrats and Republicans, echo=False, warning=False, message=False}
boxplot(legislator_DemRep_Age_data$AgeInYears~legislator_DemRep_Age_data$party, main=  "Variance in the Age", xlab = "Political Party", ylab = "Age in Years")
```

### Performing two sided Wilcoxon rank-sum test
In order to prove the null hypothesis we perform the Wilcoxon rank-sum test. our data satisfies the requirements for conducting this test.

```{r Wilcoxon rank-sum test, echo=True, warning=True, message=True }

wilcox.test(legislator_DemRep_Age_data$AgeInYears~legislator_DemRep_Age_data$party, mu=0, alt = "two.sided", conf.int = T, conf.level=0.95,  paired=F, exact=F, correct=T)
```

#### With p-value being less that 0.05, We are rejecting the null hypothesis. 
Which stated that the probability that the Democrat legislators are older than Republicans is same as the probability of Republican legislators being older than their Democrat counterpart.

## Observation
### It is our opinion that in this scenario where we have an option to run either parametric or non-parametric test, we should choose parametric t-test becasue it has more statistical power as compared to non-parametric test such as wilcoxon Rank-Sum test.

Our data fulfills all the requirements to run a t-test

1. The samples are independent of one another and are Metric scale.
2. The populations have equal variance or spread
3. The populations are normally distributed (iid)
```{r}
t.test(legislator_DemRep_Age_data$AgeInYears~legislator_DemRep_Age_data$party, mu=0, alt = "two.sided", conf=0.95, var.eq=F, paired=F)
```
#### We are rejecting the null hypothesis. 
Which stated that the probability that the Democrat legislators are older than Republicans is same as the probability of Republican legislators being older than their Democrat counterpart.
The t-test further observes that the mean age of Democrat legislators is 2.60071 years higher than their Republican counterpart.

## Test Outcome and it's correctness
Our test sample size is >30 so t-test can be performed

1. We used mean to create our test statistics which is well accepted  distributions for statistical testing.
2. we followed the decision rules of a hypothesis testing which gives us the guarantee that our false positive rejection rate (the type 1 error rate) is bounded.  
3. Our test is statistically significant as our p-value is less than 0.05 

 
## Conclusion
It is important to observe the data before choosing the right kind of test to make correct predictions and to leverage the full power of statistics.

